# Tutorial PatrÃ³n SAGA con Traefik

## DescripciÃ³n
Este proyecto es un ejemplo genÃ©rico de cÃ³mo implementar el **PatrÃ³n SAGA** en un entorno de microservicios utilizando **Flask** y gestionando el trÃ¡fico con **Traefik**. Incluye ejemplos de ejecuciÃ³n de sagas exitosas y fallidas, mostrando cÃ³mo manejar compensaciones automÃ¡ticamente.

## Requisitos Previos
Antes de comenzar, asegÃºrate de tener instalados los siguientes componentes:

- Python 3.10+
- Docker y Docker Compose
- Traefik configurado como reverse proxy
- Requests (`pip install requests`)
- Postman o herramienta similar para probar endpoints (opcional)

## CaracterÃ­sticas

- ImplementaciÃ³n del PatrÃ³n SAGA

- IntegraciÃ³n con Traefik como reverse proxy

- Ejemplos de ejecuciÃ³n exitosa y fallida

- Manejo de compensaciones automÃ¡ticas en caso de error

## 1. InstalaciÃ³n

Clona el repositorio:
```bash
git clone "https://github.com/Davidaguero1402/Tutorial_saga.git"
cd tu_repositorio
```

## 2.Levanta Traefik:
```bash
cd .\traefik\
docker compose up --build  
```

## 3. Levanta los microservicios
Antes de ejecutar el comando debemos revisar el .env y asegurarnos que para este ejemplo la variable de entorno "ENVIRONMENT" sea igual a "TRAEFIK"
```bash
cd ..
docker compose up --build  
```
## 4. Test del patron saga en Traefik 

```bash
python test/cliente_saga_traefik.py
```
## 5. Resultado esperado

```bash
---- âœ… SAGA EXITOSA ----
Status: 200
Texto de respuesta:
{
  "status": "OK"
}
---- âŒ SAGA FALLIDA ----
Status: 500
Texto de respuesta:
{
  "error": "Error en MS2, compensando acciones previas..."
}
```



---
## Crea y activa un entorno virtual:

```python
python -m venv .venv
source .venv/bin/activate  # Linux / macOS
.venv\Scripts\activate     # Windows
```

## Instala dependencias:

```bash
pip install -r requirements.txt
```


## ğŸ“ Estructura del Proyecto
```
Tutorial_saga/
â”‚
â”œâ”€â”€ ms_uno/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ config/              # Config del microservicio 1
â”‚   â”‚   â””â”€â”€ resource/            # Endpoints del microservicio 1
â”‚   â”œâ”€â”€ .venv/                   # Entorno virtual aislado
â”‚   â”œâ”€â”€ main.py                  # Punto de entrada del microservicio
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ ms_dos/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ config/              # Config del microservicio 2
â”‚   â”‚   â””â”€â”€ resource/            # Endpoints del microservicio 2
â”‚   â”œâ”€â”€ .venv/
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ saga_orquestador/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ resource/
â”‚   â”‚   â””â”€â”€ saga_router.py       # LÃ³gica central del patrÃ³n Saga
â”‚   â”œâ”€â”€ .venv/
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ traefik/
â”‚   â”œâ”€â”€ traefik.yml              # ConfiguraciÃ³n principal de Traefik
â”‚   â”œâ”€â”€ dynamic_conf.yml         # ConfiguraciÃ³n dinÃ¡mica de rutas y middlewares
â”‚   â”œâ”€â”€ acme.json                # Certificados SSL (si aplica)
â”‚   â””â”€â”€ Dockerfile (opcional)
â”‚
â”œâ”€â”€ docker-compose.yml           # OrquestaciÃ³n general (Traefik + microservicios)
â””â”€â”€ README.md
```